name: repo2docker
on: push

jobs:     
  repo2docker:
    runs-on: ubuntu-latest
    steps:

    - name: Copy Repo Contents
      uses: actions/checkout@master
      with:
        persist-credentials: false

    - uses: actions/setup-python@v2
      with:
        python-version: '3.6'

    - name: Setup tmate session
      uses: mxschmitt/action-tmate@v2
      env:
        REPO_TOKEN: ${{ secrets.GITHUB_TOKEN }}

    - name: login to docker
      run: |
        echo $REPO_TOKEN | docker login https://docker.pkg.github.com -u "github-actions[bot]" --password-stdin
    env:
        REPO_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        
    - name: build container
      run: |
        pip install jupyter-repo2docker
        jupyter-repo2docker --no-run --debug .
